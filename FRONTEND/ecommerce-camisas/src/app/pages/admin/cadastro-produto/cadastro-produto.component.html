<div class="container mt-4">
  <div class="card p-4 shadow-sm border-0 mx-auto"
       style="border-radius: 20px; max-width: 1000px; background-color: white;">

    <h2 class="text-center mb-4 fw-bold">Gest√£o de Mantos ‚öΩ</h2>

    <div class="row g-4">

      <!-- FORMUL√ÅRIO -->
      <div class="col-md-6">

        <div class="mb-3">
          <label class="form-label fw-bold">Nome do Manto:</label>
          <input type="text"
                 [(ngModel)]="produto.nome"
                 class="form-control form-control-lg"
                 style="border-radius: 10px;">
        </div>

        <div class="mb-3">
          <label class="form-label fw-bold">Pre√ßo (R$):</label>
          <input type="number"
                 [(ngModel)]="produto.preco"
                 class="form-control form-control-lg"
                 style="border-radius: 10px;">
        </div>

        <div class="mb-3">
          <label class="form-label fw-bold">Quantidade em Estoque:</label>
          <input type="number"
                 [(ngModel)]="produto.estoque"
                 class="form-control form-control-lg"
                 style="border-radius: 10px;">
        </div>

        <button (click)="salvar()"
                class="btn btn-success w-100 fw-bold py-3 mt-3 shadow-sm"
                style="border-radius: 12px; font-size: 1.1rem;">
          {{ editando ? 'ATUALIZAR MANTO üîÑ' : 'CADASTRAR MANTO ‚úÖ' }}
        </button>

      </div>

      <!-- √ÅREA DE IMAGEM -->
      <div class="col-md-6">

        <input type="file"
               #fileInput
               accept="image/*"
               (change)="onFileSelected($event)"
               hidden>

        <div (click)="fileInput.click()"
             class="border rounded d-flex flex-column align-items-center justify-content-center bg-light h-100 p-4"
             style="min-height: 300px;
                    border-style: dashed !important;
                    border-width: 2px;
                    border-radius: 20px;
                    cursor: pointer;">

          <div *ngIf="produto.imagem_url" class="text-center">

            <img [src]="produto.imagem_url"
                 style="max-height: 220px;"
                 class="img-fluid mb-3">

            <button type="button"
                    (click)="removerImagem()"
                    class="btn btn-sm btn-outline-danger">
              Remover imagem ‚ùå
            </button>

          </div>

          <div class="text-center text-muted" *ngIf="!produto.imagem_url">
            <span style="font-size: 60px;">üì∑</span>
            <p class="mt-3 fw-bold mb-0">
              Clique para adicionar a foto do manto
            </p>
          </div>

        </div>

      </div>

    </div>

    <!-- BUSCA -->
    <div class="mt-5">

      <div class="input-group mb-4 shadow-sm"
           style="border-radius: 25px; overflow: hidden;">
        <span class="input-group-text bg-white border-end-0 ps-3">üîç</span>
        <input type="text"
               [(ngModel)]="filtro"
               class="form-control border-start-0 py-2"
               placeholder="Pesquisar na sua cole√ß√£o...">
      </div>

      <h5 class="fw-bold mb-3">Sua Cole√ß√£o Atual:</h5>

      <!-- LISTA MODERNA -->
      <div *ngFor="let p of produtosFiltrados"
           class="card mb-3 shadow-sm border-0"
           style="border-radius: 15px;">

        <div class="card-body d-flex justify-content-between align-items-center">

          <div class="d-flex align-items-center gap-3">

            <img [src]="p.imagem_url || 'assets/camisa-exemplo.png'"
                 style="width: 70px; height: 70px; object-fit: contain; border-radius: 10px;">

            <div>
              <h6 class="mb-1 fw-bold">{{ p.nome }}</h6>

              <span class="text-success fw-bold">
                R$ {{ p.preco | number:'1.2-2' }}
              </span>

              <div class="text-muted small">
                Estoque: {{ p.estoque }}
              </div>
            </div>

          </div>

          <div class="d-flex gap-2">

            <button (click)="editar(p)"
                    class="btn btn-sm btn-primary">
              ‚úèÔ∏è
            </button>

            <button (click)="excluir(p.id)"
                    class="btn btn-sm btn-danger">
              üóëÔ∏è
            </button>

          </div>

        </div>

      </div>

      <div *ngIf="produtosFiltrados.length === 0"
           class="text-center py-5">
        <p class="text-muted fw-bold">
          Nenhum manto encontrado com "{{ filtro }}". üëï
        </p>
      </div>

    </div>

  </div>
</div>